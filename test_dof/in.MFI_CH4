log             log.MFI_CH4 #append	# append: to extend
units           real				# 1A, 1fs, kcal, K
boundary        p p p				# 3D periodic
box             tilt large 			# triclinic (non-orthogonal) simulation boxes

atom_style      full				# full: molecular and charge

pair_style      lj/cut 12.50		# cutoff Lennard-Jones potential with no Coulomb
pair_modify     tail yes mix arithmetic 	# tail and mix method
special_bonds   lj/coul 0.0 0.0 1.0			#
dielectric      1.0					# dielectric constant for Coulombic interactions

read_data       data.MFI_CH4		# load structures

#### Atom Groupings ####
group           CH4    type    3	# define groups
group           fram   type    1:2	# define groups
#### END Atom Groupings ####

#### SETTINGS ####
variable        stemp equal 298.00	# simulation temperature
variable        dt     equal 1.00	# dt = 1fs
variable        tdamp  equal 100*${dt}

compute         allTemp all temp	# compute temp of all
compute         CH4Temp CH4 temp	# compute temp of CH4
# compute         CH4Temp2 CH4 temp	# compute temp of CH4
compute         framTemp fram temp  # compute temp of framework
# compute         allke all ke        # compute ke of CH4
compute         CH4ke CH4 ke        # compute ke of CH4
# compute         framke fram ke      # compute ke of framework
# variable        Vcm equal vcm(all,x)+vcm(all,y)+vcm(all,z)
# variable        Vcm equal vcm(CH4,x)+vcm(CH4,y)+vcm(CH4,z)

# compute_modify  allTemp extra/dof 0 dynamic/dof yes
# compute_modify  CH4Temp dynamic/dof yes
# compute_modify  CH4Temp extra/dof 0 dynamic/dof yes
# compute_modify  framTemp extra/dof 0
# compute_modify  allke extra/dof  0
# compute_modify  CH4ke extra/dof  0 dynamic/dof yes
# compute_modify  framke extra/dof  0

thermo_style    custom step c_allTemp c_CH4Temp  c_CH4ke c_framTemp #c_framTemp #ke c_CH4ke c_framke v_Vcm
#etotal pe press	vol# print thermo info
#### END SETTINGS ####

## data collection
fix             1 CH4 nvt temp ${stemp} ${stemp} ${tdamp}
neigh_modify    exclude group CH4 CH4 		# exclude pairwise interaction
thermo          1
dump            file1 all custom 1000 dump.lammpstrj id type x y z
dump            file2 CH4 custom 1000 dump_CH4.lammpstrj id type x y z
dump            file3 CH4 custom 1000 CH4_velocities.dat id type vx vy vz fx fy fz
run             10000
